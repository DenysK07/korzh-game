<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KORZH Clicker</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            background-color: #1a1a1a;
            color: white;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            user-select: none;
        }

        .header { margin-top: 20px; text-align: center; }
        h1 { font-size: 24px; margin: 0; color: #f0c420; }
        #score { font-size: 48px; font-weight: bold; margin-top: 10px; }
        .currency { font-size: 16px; color: #888; }

        .game-area {
            flex-grow: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            width: 100%;
        }

        #korzh-btn {
            width: 260px;
            height: 260px;
            border-radius: 50%;
            background-image: url('korzh.jpg'); /* –¢–≤–æ—î –≥–æ–ª–æ–≤–Ω–µ —Ñ–æ—Ç–æ */
            background-size: cover;
            background-position: center;
            box-shadow: 0 0 30px rgba(240, 196, 32, 0.3);
            border: 5px solid #f0c420;
            cursor: pointer;
            transition: transform 0.1s;
            -webkit-tap-highlight-color: transparent;
            z-index: 10;
        }

        #korzh-btn:active { transform: scale(0.95); }

        /* –°—Ç–∏–ª—å –¥–ª—è –µ–ª–µ–º–µ–Ω—Ç–∞, —â–æ –ª–µ—Ç–∏—Ç—å (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä) */
        .floating-element {
            position: absolute;
            pointer-events: none;
            animation: floatUp 0.8s forwards; /* –ê–Ω—ñ–º–∞—Ü—ñ—è –ø–æ–ª—å–æ—Ç—É */
            z-index: 20;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è —Å–∞–º–æ—ó –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∫—Ä–∏—Ö—Ç–∏ */
        .floating-element img {
            width: 40px; /* –†–æ–∑–º—ñ—Ä –∫—Ä–∏—Ö—Ç–∏ */
            height: auto;
        }

        @keyframes floatUp {
            0% { opacity: 1; transform: translateY(0) rotate(0deg); }
            100% { opacity: 0; transform: translateY(-100px) rotate(180deg); } /* –õ–µ—Ç–∏—Ç—å –≤–≥–æ—Ä—É —ñ –∫—Ä—É—Ç–∏—Ç—å—Å—è */
        }

        .menu {
            width: 90%;
            display: flex;
            justify-content: space-between;
            padding-bottom: 20px;
            gap: 10px;
        }

        .menu-btn {
            background: #333;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 12px;
            flex-grow: 1;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .menu-btn:active { background: #444; }

        #message-box {
            position: absolute;
            top: 20px;
            background: rgba(0, 128, 0, 0.8);
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.5s;
            pointer-events: none;
            z-index: 30;
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>KORZH COIN</h1>
        <div class="currency">–ö—Ä–∏—Ö—Ç–∏</div>
        <div id="score">0</div>
        <div style="font-size: 12px; color: #555; margin-top: 5px;">–°–∏–ª–∞ –∫–ª—ñ–∫—É: <span id="power-display">1</span></div>
    </div>

    <div id="message-box">–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</div>

    <div class="game-area">
        <div id="korzh-btn"></div>
    </div>

    <div class="menu">
        <button class="menu-btn" onclick="buyBoost()">‚ö°Ô∏è –°–∫–∞–ª–∫–∞ (100)</button>
        <button class="menu-btn" onclick="showFriends()">üë• –î—Ä—É–∑—ñ</button>
        <button class="menu-btn" onclick="alert('–°–∫–æ—Ä–æ!')">üí∞ –í–∏–≤—ñ–¥</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let score = localStorage.getItem('korzh_score') ? parseInt(localStorage.getItem('korzh_score')) : 0;
        let power = localStorage.getItem('korzh_power') ? parseInt(localStorage.getItem('korzh_power')) : 1;

        const scoreEl = document.getElementById('score');
        const powerEl = document.getElementById('power-display');
        const korzhBtn = document.getElementById('korzh-btn');
        const gameArea = document.querySelector('.game-area');
        const msgBox = document.getElementById('message-box');

        scoreEl.innerText = score;
        powerEl.innerText = power;
        updateBoostButton();

        // –û–±—Ä–æ–±–∫–∞ –∫–ª—ñ–∫—ñ–≤ (–º–∏—à–∫–∞ —ñ –ø–∞–ª–µ—Ü—å)
        korzhBtn.addEventListener('click', (e) => handleTap(e.clientX, e.clientY));
        korzhBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            for (let i = 0; i < e.touches.length; i++) {
                handleTap(e.touches[i].clientX, e.touches[i].clientY);
            }
        });

        function handleTap(x, y) {
            score += power;
            scoreEl.innerText = score;
            localStorage.setItem('korzh_score', score);

            if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');
            
            // –ï—Ñ–µ–∫—Ç –Ω–∞—Ö–∏–ª—É
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            const tiltX = (y - centerY) / 20;
            const tiltY = (centerX - x) / 20;
            korzhBtn.style.transform = `perspective(1000px) rotateX(${tiltX}deg) rotateY(${tiltY}deg) scale(0.95)`;
            setTimeout(() => korzhBtn.style.transform = 'scale(1)', 100);

            // –í–∏–∫–ª–∏–∫–∞—î–º–æ –Ω–æ–≤—É —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è –ø–æ–∫–∞–∑—É –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∫—Ä–∏—Ö—Ç–∏
            showFloatingCrumb(x, y);
        }

        function buyBoost() {
            const price = 100 * power;
            if (score >= price) {
                score -= price;
                power++;
                localStorage.setItem('korzh_score', score);
                localStorage.setItem('korzh_power', power);
                scoreEl.innerText = score;
                powerEl.innerText = power;
                showMessage(`‚úÖ –ö—É–ø–ª–µ–Ω–æ! –°–∏–ª–∞: ${power}`);
                updateBoostButton();
            } else {
                showMessage(`‚ùå –¢—Ä–µ–±–∞ ${price} –∫—Ä–∏—Ö—Ç!`);
                if (tg.HapticFeedback) tg.HapticFeedback.notificationOccurred('error');
            }
        }

        function updateBoostButton() {
            document.querySelector('.menu-btn').innerText = `‚ö°Ô∏è –°–∫–∞–ª–∫–∞ (${100 * power})`;
        }

        function showFriends() {
            tg.showPopup({ title: '–†–µ—Ñ–µ—Ä–∞–ª–∏', message: '–°–∫–æ—Ä–æ!', buttons: [{type: 'ok'}] });
        }

        // --- –ù–û–í–ê –§–£–ù–ö–¶–Ü–Ø –î–õ–Ø –ö–†–ò–•–¢ ---
        function showFloatingCrumb(x, y) {
            const el = document.createElement('div');
            el.classList.add('floating-element');
            
            // –°—Ç–≤–æ—Ä—é—î–º–æ –∫–∞—Ä—Ç–∏–Ω–∫—É –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ
            const img = document.createElement('img');
            img.src = 'crumb.png'; // –û—Å—å —Ç—É—Ç –∫–æ–¥ —à—É–∫–∞—î —Ç–≤—ñ–π —Ñ–∞–π–ª
            el.appendChild(img);

            // –í–∏–ø–∞–¥–∫–æ–≤–∏–π –∑—Å—É–≤, —â–æ–± –∫—Ä–∏—Ö—Ç–∏ –ª–µ—Ç—ñ–ª–∏ —Ç—Ä–æ—Ö–∏ –≤ —Ä—ñ–∑–Ω—ñ –±–æ–∫–∏
            const randomX = (Math.random() - 0.5) * 60;
            el.style.left = `${x + randomX}px`;
            el.style.top = `${y}px`;
            
            gameArea.appendChild(el);
            
            // –í–∏–¥–∞–ª—è—î–º–æ –∫—Ä–∏—Ö—Ç—É, –∫–æ–ª–∏ –∞–Ω—ñ–º–∞—Ü—ñ—è –∑–∞–∫—ñ–Ω—á–∏–ª–∞—Å—å
            setTimeout(() => el.remove(), 800);
        }

        function showMessage(text) {
            msgBox.innerText = text;
            msgBox.style.opacity = 1;
            setTimeout(() => msgBox.style.opacity = 0, 2000);
        }
    </script>
</body>
</html>
